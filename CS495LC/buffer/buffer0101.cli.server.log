CMBEGIN,Nov 28 12:11:06,/usr/src/fhttpd,ls,frobnick  index.html  Makefile<HT>webserver  webserver.c,ls
CMBEGIN,Nov 28 12:11:19,/usr/src/fhttpd,sudo make,make: Nothing to be done for 'project'.,sudo make
CMBEGIN,Nov 28 12:11:28,/usr/src/fhttpd,sudo ./webserver 8080,GET / HTTP/1.1<NL><NL>User-Agent: Wget/1.17.1 (linux-gnu)<NL><NL>Accept: */*<NL><NL>Accept-Encoding: identity<NL><NL>Host: localhost:8080<NL><NL>Connection: Keep-Alive<NL><NL><NL>GET /hurhurrrrrrrr HTTP/1.1<NL><NL>User-Agent: Wget/1.17.1 (linux-gnu)<NL><NL>Accept: */*<NL><NL>Accept-Encoding: identity<NL><NL>Host: localhost:8080<NL><NL>Connection: Keep-Alive<NL><NL><NL>GET /hurhurrrrrrrrrrrrrrrrrrrrrrrr HTTP/1.1<NL><NL>User-Agent: Wget/1.17.1 (linux-gnu)<NL><NL>Accept: */*<NL><NL>Accept-Encoding: identity<NL><NL>Host: localhost:8080<NL><NL>Connection: Keep-Alive<NL><NL><NL>GET /hurhurrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr HTTP/1.1<NL><NL>User-Agent: Wget/1.17.1 (linux-gnu)<NL><NL>Accept: */*<NL><NL>Accept-Encoding: identity<NL><NL>Host: localhost:8080<NL><NL>Connection: Keep-Alive<NL><NL><NL>GET /hurhurrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr4444444445454545454545454545454 HTTP/1.1<NL><NL>User-Agent: Wget/1.17.1 (linux-gnu)<NL><NL>Accept: */*<NL><NL>Accept-Encoding: identity<NL><NL>Host: localhost:8080<NL><NL>Connection: Keep-Alive<NL><NL><NL>GET /llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll HTTP/1.1<NL><NL>User-Agent: Wget/1.17.1 (linux-gnu)<NL><NL>Accept: */*<NL><NL>Accept-Encoding: identity<NL><NL>Host: localhost:8080<NL><NL>Connection: Keep-Alive<NL><NL><NL>GET /llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll HTTP/1.1<NL><NL>User-Agent: Wget/1.17.1 (linux-gnu)<NL><NL>Accept: */*<NL><NL>Accept-Encoding: identity<NL><NL>Host: localhost:8080<NL><NL>Connection: Keep-Alive<NL><NL><NL>GET /llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll HTTP/1.1<NL><NL>User-Agent: Wget/1.17.1 (linux-gnu)<NL><NL>Accept: */*<NL><NL>Accept-Encoding: identity<NL><NL>Host: localhost:8080<NL><NL>Connection: Keep-Alive<NL><NL><NL>GET /llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll HTTP/1.1<NL><NL>User-Agent: Wget/1.17.1 (linux-gnu)<NL><NL>Accept: */*<NL><NL>Accept-Encoding: identity<NL><NL>Host: localhost:8080<NL><NL>Connection: Keep-Alive<NL><NL><NL>Segmentation fault (core dumped),sudo ./webserver 8080
CMBEGIN,Nov 28 12:23:13,/usr/src/fhttpd,sudo make,make: Nothing to be done for 'project'.,sudo make
CMBEGIN,Nov 28 12:23:14,/usr/src/fhttpd,sudo ./webserver 8080,bind: Address already in use,sudo ./webserver 8080
CMBEGIN,Nov 28 12:23:19,/usr/src/fhttpd,sudo ./webserver 8081,exit<NL>quit<NL>q<NL>GET /llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll HTTP/1.1<NL><NL>User-Agent: Wget/1.17.1 (linux-gnu)<NL><NL>Accept: */*<NL><NL>Accept-Encoding: identity<NL><NL>Host: localhost:8081<NL><NL>Connection: Keep-Alive<NL><NL><NL>Segmentation fault (core dumped),sudo ./webserver 8081
CMBEGIN,,,exit,exit,
CMBEGIN,,,cd /usr/src/fhttpd,,
CMBEGIN,Nov 28 12:14:17,/usr/src/fhttpd,cp webserver.c webserver.orig.c,cp: cannot create regular file 'webserver.orig.c': Permission denied,cp webserver.c webserver.orig.c
CMBEGIN,,,sudo ,,
CMBEGIN,Nov 28 12:14:27,/usr/src/fhttpd,ls,frobnick  index.html  Makefile<HT>webserver  webserver.c<HT>webserver.orig.c,ls
CMBEGIN,,,sudo cp webserver.c webserver.orig.c,,
CMBEGIN,Nov 28 12:14:58,/usr/src/fhttpd,wget http://localhost:8080/hurhurrrrrrrr,%--2018-11-28 12:14:58--  http://localhost:8080/hurhurrrrrrrr<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8080... connected.<NL>HTTP request sent%% awaiting response... 404 Not Found<NL>2018-11-28 12:14:58 ERROR 404: Not Found.<NL>%,wget http://localhost:8080/hurhurrrrrrrr
CMBEGIN,,,wget http://localhost:8080/hurhurrrrrrrrrrrrrrr ,%rrrrrrrrr<NL>--2018-11-28 12:15:04--  http://localhost:8080/hurhurrrrrrrrrrrrrrrrrrrrrrrr<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8080... connected.<NL>HTTP request sent%% awaiting response... 404 Not Found<NL>2018-11-28 12:15:04 ERROR 404: Not Found.<NL>%,
CMBEGIN,,,wget http://localhost:8080/hurhurrrrrrrrrrrrrrrr,%rrrrrrrrrrrrrrrrrrrrrrr<NL>--2018-11-28 12:15:07--  http://localhost:8080/hurhurrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8080... connected.<NL>HTTP request sent%% awaiting response... 404 Not Found<NL>2018-11-28 12:15:07 ERROR 404: Not Found.<NL>%,
CMBEGIN,,,wget http://localhost:8080/hurhurrrrrrrrrrrrrrrr,%rrrrrrrrrrrrrrrrrrrrrrr4444444445454545454545454545454<NL>--2018-11-28 12:15:11--  http://localhost:8080/hurhurrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr4444444445454545454545454545454<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8080... connected.<NL>HTTP request sent%% awaiting response... 404 Not Found<NL>2018-11-28 12:15:11 ERROR 404: Not Found.<NL>%,
CMBEGIN,,,wget http://localhost:8080/hurhurrrrrrrrrrrrrrrr,,
CMBEGIN,,,wget http://localhost:8080/hurhurrrrrrrrrrrrrrr ,,
CMBEGIN,,,wget http://localhost:8080/hurhurrrrrrrrrrrrrr,,
CMBEGIN,,,wget http://localhost:8080/hurhurrrrrrrrrrrrrrrr,rrrrrrrrrrrrrrrrrrrrrrr<NL>rrrrrrrrr<ESC>[K<ESC>[Aserver:/usr/src/fhttpd$ wget http://localhost:8080/hurhurrrrrrrr<ESC>[K<NL>,
CMBEGIN,,,wget http://localhost:8080/hurhurrrrrrrr,,
CMBEGIN,,,sudo cp webserver.c webserver.orig.c,,
CMBEGIN,Nov 28 12:15:28,/usr/src/fhttpd,sudo nano webserver.c,%(B===(B(B[ Reading File ]<NL>(B(B[ Read 519 lines ]<NL>(B(B  GNU nano 2.5.3             File: webserver.c                                  (B// webserver.c<NL>// FrobozzCo Official Webserver<NL>// Barbazzo Fernap barbazzo@gue.com<NL>// Gustar Woomax gustar@gue.com<NL>// Wilbar Memboob wilbar@gue.com<NL>// By the Frobozz Magic Webserver Company<NL>// Released under the Grue Public License<NL>// Frobruary 14th%% 1067 GUE<NL>// THERE IS NO WARRANTY FOR THE PROGRAM%% TO THE EXTENT PERMITTED<NL>// BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE(B <NL>(B// COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM <C3><CENT>^<C3><EURO>^<C3><L_OE>AS IS<C3><CENT>^<C3><EURO>^<C3><9D>(B <NL>(B// WITHOUT WARRANTY OF ANY KIND%% EITHER EXPRESSED OR IMPLIED%% INCLUDING%%(B <NL>(B// BUT NOT LIMITED TO%% THE IMPLIED WARRANTIES OF MERCHANTABILITY AND(B <NL>(B// FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY(B <NL>(B// AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE(B <NL>(B// DEFECTIVE%% *AND IT WILL*%% YOU ASSUME THE COST OF ALL NECESSARY(B <NL>(B// SERVICING%% REPAIR OR CORRECTION.<NL>(B^G(B Get Help  (B^O(B Write Out (B^W(B Where Is  (B^K(B Cut Text  (B^J(B Justify   (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File (B^\(B Replace   (B^U(B Uncut Text(B^T(B To Spell  (B^_(B Go To Line<NL>78(B#include(B (B<stdio.h><NL>#include(B (B<errno.h><NL>#include(B (B<string.h><NL>#include(B (B<stdlib.h><NL>#include(B (B<netdb.h><NL>#include(B (B<sys/stat.h><NL>#include(B (B<sys/types.h><NL>#include(B (B<sys/socket.h><NL>#include(B (B<netinet/in.h><NL>(B78(B#include(B (B<arpa/inet.h><NL>#include(B (B<unistd.h><NL>#include(B (B<fcntl.h><NL>#include(B (B<time.h><NL>#include(B (B<pthread.h><NL>#define(B (B_XOPEN_SOURCE<NL>(Btypedef(B struct(B {char(B *method;<NL>78char(B *uri;char(B *version;char(B *headers;<NL>} httpreq_t;<NL>(B/* NOTE: this function is based on a function provided in the GNU "timegm" man<NL>   page. timegm is a GNU extension to time.h that returns the given tm struct as   a UNIX timestamp in GMT/UTC%% rather than local time. The man page suggests a<NL>   function similar to the one below as a portable equivalent.<NL>(B78(B */<NL>(Btime_t my_timegm(struct(B tm *tm) {time_t ret;char(B *tz;tz = getenv((B"TZ"(B);putenv((B"TZ=GMT"(B);tzset();ret = mktime(tm);(Bif(B (tz) {<NL>78char(B envstr[strlen(tz) + 4];envstr[0] = (B'\0'(B;strcat(envstr%% (B"TZ="(B);strcat(envstr%% tz);putenv(envstr);} (Belse(B {putenv((B"TZ="(B);tzset();<NL>78return(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];<NL>78strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end o(B$<NL>>(B(B  GNU nano 2.5.3             File: webserver.c                                  (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end o(B$<NL>(B^G(B Get Help  (B^O(B Write Out (B^W(B Where Is  (B^K(B Cut Text  (B^J(B Justify   (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File (B^\(B Replace   (B^U(B Uncut Text(B^T(B To Spell  (B^_(B Go To Line<NL>===(B  GNU nano 2.5.3             File: webserver.c                                  (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end o(B$<NL>(B^G(B Get Help  (B^O(B Write Out (B^W(B Where Is  (B^K(B Cut Text  (B^J(B Justify   (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File (B^\(B Replace   (B^U(B Uncut Text(B^T(B To Spell  (B^_(B Go To Line<NL>(B File: webserver.c  (Bf (B$int(B hdrvallen = strlen(hdrval);<NL><NL>>(B(B  GNU nano 2.5.3              File: webserver.c                                   (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of (B$int(B hdrvallen = strlen(hdrval);<NL>(B^G(B Get Help  (B^O(B Write Out (B^W(B Where Is  (B^K(B Cut Text  (B^J(B Justify   (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File (B^\(B Replace   (B^U(B Uncut Text(B^T(B To Spell  (B^_(B Go To Line<NL>===(B  GNU nano 2.5.3              File: webserver.c                                   (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of (B$int(B hdrvallen = strlen(hdrval);<NL>(B^G(B Get Help  (B^O(B Write Out (B^W(B Where Is  (B^K(B Cut Text  (B^J(B Justify   (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File (B^\(B Replace   (B^U(B Uncut Text(B^T(B To Spell  (B^_(B Go To Line<NL>(B File: webserver.c  (Bhe(B$ (B^O(B Write Out  (B^W(B Where Is   (B^K(B Cut Text   (B^J(B Justify    (B^C(B Cur Pos (B^R(B Read File  (B^\(B Replace    (B^U(B Uncut Text (B^T(B To Spell   (B^_(B Go To Line<NL><NL>>(B(B  GNU nano 2.5.3               File: webserver.c                                    (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of he(B$int(B hdrvallen = strlen(hdrval);<NL>(B^G(B Get Help   (B^O(B Write Out  (B^W(B Where Is   (B^K(B Cut Text   (B^J(B Justify    (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File  (B^\(B Replace    (B^U(B Uncut Text (B^T(B To Spell   (B^_(B Go To Line<NL>===(B  GNU nano 2.5.3               File: webserver.c                                    (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of he(B$int(B hdrvallen = strlen(hdrval);<NL>(B^G(B Get Help   (B^O(B Write Out  (B^W(B Where Is   (B^K(B Cut Text   (B^J(B Justify    (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File  (B^\(B Replace    (B^U(B Uncut Text (B^T(B To Spell   (B^_(B Go To Line<NL>(B File: webserver.c   (Bade(B$retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// ma(B$<NL>>(B(B  GNU nano 2.5.3                File: webserver.c                                      (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of heade(B$int(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// ma(B$<NL>(B^G(B Get Help   (B^O(B Write Out  (B^W(B Where Is   (B^K(B Cut Text   (B^J(B Justify    (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File  (B^\(B Replace    (B^U(B Uncut Text (B^T(B To Spell   (B^_(B Go To Line<NL>===(B  GNU nano 2.5.3                File: webserver.c                                      (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of heade(B$int(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// ma(B$<NL>(B^G(B Get Help   (B^O(B Write Out  (B^W(B Where Is   (B^K(B Cut Text   (B^J(B Justify    (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File  (B^\(B Replace    (B^U(B Uncut Text (B^T(B To Spell   (B^_(B Go To Line<NL>(B File: webserver.c     (Br val(B$(Blloc (B$strcpy(retval%% (char(B *)hdrval);<NL>(BG(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line<NL><NL>>(B(B  GNU nano 2.5.3                 File: webserver.c                                          (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header val(B$int(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc (B$strcpy(retval%% (char(B *)hdrval);<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line<NL>===(B  GNU nano 2.5.3                 File: webserver.c                                          (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header val(B$int(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc (B$strcpy(retval%% (char(B *)hdrval);<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line<NL>(B  File: webserver.c     (Ba spa(B$} (Belse(B {<NL>(BG(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify      (B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line<NL><NL>>(B(B  GNU nano 2.5.3                   File: webserver.c                                             (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a spa(B$strcpy(retval%% (char(B *)hdrval);} (Belse(B {<NL>(B^G(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line<NL>===(B  GNU nano 2.5.3                   File: webserver.c                                             (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a spa(B$strcpy(retval%% (char(B *)hdrval);} (Belse(B {<NL>(B^G(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line<NL>(B File: webserver.c    (Bce f(B$retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//<NL>(B(BG(B Get Help   (B^O(B Write Out  (B^W(B Where Is   (B^K(B Cut Text   (B^J(B Justify    (B^C(B Cur Pos    (B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File  (B^\(B Replace    (B^U(B Uncut Text (B^T(B To Spell   (B^_(B Go To Line (B^V(B Next Page<NL><NL>>(B(B  GNU nano 2.5.3                    File: webserver.c                                                (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space f(B$strcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//<NL>(B^G(B Get Help   (B^O(B Write Out  (B^W(B Where Is   (B^K(B Cut Text   (B^J(B Justify    (B^C(B Cur Pos    (B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File  (B^\(B Replace    (B^U(B Uncut Text (B^T(B To Spell   (B^_(B Go To Line (B^V(B Next Page<NL>===(B  GNU nano 2.5.3                    File: webserver.c                                                (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space f(B$strcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//<NL>(B^G(B Get Help   (B^O(B Write Out  (B^W(B Where Is   (B^K(B Cut Text   (B^J(B Justify    (B^C(B Cur Pos    (B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File  (B^\(B Replace    (B^U(B Uncut Text (B^T(B To Spell   (B^_(B Go To Line (B^V(B Next Page<NL>(B File: webserver.c   (Bor (B$<NL>>(B(B  GNU nano 2.5.3                     File: webserver.c                                                  (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for (B$strcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//<NL>(B^G(B Get Help   (B^O(B Write Out  (B^W(B Where Is   (B^K(B Cut Text   (B^J(B Justify    (B^C(B Cur Pos    (B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File  (B^\(B Replace    (B^U(B Uncut Text (B^T(B To Spell   (B^_(B Go To Line (B^V(B Next Page<NL>===(B  GNU nano 2.5.3                     File: webserver.c                                                  (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for (B$strcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//<NL>(B^G(B Get Help   (B^O(B Write Out  (B^W(B Where Is   (B^K(B Cut Text   (B^J(B Justify    (B^C(B Cur Pos    (B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File  (B^\(B Replace    (B^U(B Uncut Text (B^T(B To Spell   (B^_(B Go To Line (B^V(B Next Page<NL>(B File: webserver.c  (Bre(B$strcpy(retval%% hdrptr);<NL>(BG(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page<NL><NL>>(B(B  GNU nano 2.5.3                      File: webserver.c                                                   (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for re(B$strcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page<NL>===(B  GNU nano 2.5.3                      File: webserver.c                                                   (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for re(B$strcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page<NL>(B File: webserver.c   (Btval(B<NL>>(B(B  GNU nano 2.5.3                       File: webserver.c                                                     (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page<NL>===(B  GNU nano 2.5.3                       File: webserver.c                                                     (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page<NL>(B File: webserver.c   (B}<NL>(BG(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify      (B^C(B Cur Pos      (B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page<NL><NL>>(B(B  GNU nano 2.5.3                        File: webserver.c                                                       (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}<NL>(B^G(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos(B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page<NL>===(B  GNU nano 2.5.3                        File: webserver.c                                                       (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}<NL>(B^G(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos(B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page<NL>(B File: webserver.c   (B<NL>>(B(B  GNU nano 2.5.3                         File: webserver.c                                                         (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}<NL>(B^G(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos(B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page<NL>===(B  GNU nano 2.5.3                         File: webserver.c                                                         (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}<NL>(B^G(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos(B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page<NL>(B File: webserver.c  (B}<NL><NL>>(B(B  GNU nano 2.5.3                          File: webserver.c                                                          (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos(B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page<NL>===(B  GNU nano 2.5.3                          File: webserver.c                                                          (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos(B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page<NL>(B  (B (B^O(B Write Out     (B^W(B Where Is      (B^K(B Cut Text      (B^J(B Justify       (B^C(B Cur Pos       (B^Y(B Prev Page (B^R(B Read File     (B^\(B Replace       (B^U(B Uncut Text    (B^T(B To Spell      (B^_(B Go To Line    (B^V(B Next Page<NL><NL>>(B(B  GNU nano 2.5.3                          File: webserver.c                                                            (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help(B^O(B Write Out     (B^W(B Where Is(B^K(B Cut Text(B^J(B Justify(B^C(B Cur Pos(B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File     (B^\(B Replace(B^U(B Uncut Text    (B^T(B To Spell(B^_(B Go To Line    (B^V(B Next Page<NL>===(B  GNU nano 2.5.3                          File: webserver.c                                                            (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help(B^O(B Write Out     (B^W(B Where Is(B^K(B Cut Text(B^J(B Justify(B^C(B Cur Pos(B^Y(B Prev Page<NL>(B^X(B Exit(B^R(B Read File     (B^\(B Replace(B^U(B Uncut Text    (B^T(B To Spell(B^_(B Go To Line    (B^V(B Next Page<NL>(B File: webserver.c ^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page   (BM-\(B First Line(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page   (BM-/(B Last Line<NL><NL>>(B(B  GNU nano 2.5.3                           File: webserver.c                                                            (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page   (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page   (BM-/(B Last Line<NL>===(B  GNU nano 2.5.3                           File: webserver.c                                                            (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page   (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page   (BM-/(B Last Line<NL>(B (B<NL>>(B(B  GNU nano 2.5.3                           File: webserver.c                                                             (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page   (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page   (BM-/(B Last Line<NL>===(B  GNU nano 2.5.3                           File: webserver.c                                                             (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page   (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page   (BM-/(B Last Line<NL>(B File: webserver.c  (B<NL>>(B(B  GNU nano 2.5.3                            File: webserver.c                                                              (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page   (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page   (BM-/(B Last Line<NL>===(B  GNU nano 2.5.3                            File: webserver.c                                                              (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page   (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page   (BM-/(B Last Line<NL>(B File: webserver.c   (B<NL>>(B(B  GNU nano 2.5.3                             File: webserver.c                                                                (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page   (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page   (BM-/(B Last Line<NL>===(B  GNU nano 2.5.3                             File: webserver.c                                                                (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page   (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page   (BM-/(B Last Line<NL>(B (B<NL>>(B(B  GNU nano 2.5.3                             File: webserver.c                                                                 (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page   (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page   (BM-/(B Last Line<NL>===(B  GNU nano 2.5.3                             File: webserver.c                                                                 (Breturn(B ret;<NL>char(B *get_header(const(B httpreq_t *req%% const(B char(B* headername) {char(B *hdrptr;char(B *hdrend;char(B *retval = (BNULL(B;char(B searchstr[strlen(headername) + 5];strcpy(searchstr%% (B"<NL>"(B);strcat(searchstr%% headername);strcat(searchstr%% (B": "(B);(Bif(B (hdrptr = strstr(req->headers%% searchstr)) { (Bhdrptr += strlen(searchstr); (Bif(B (hdrend = strstr(hdrptr%% (B"<NL>"(B)) { char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}}<NL>(B^G(B Get Help    (B^O(B Write Out   (B^W(B Where Is    (B^K(B Cut Text    (B^J(B Justify     (B^C(B Cur Pos     (B^Y(B Prev Page   (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File   (B^\(B Replace     (B^U(B Uncut Text  (B^T(B To Spell    (B^_(B Go To Line  (B^V(B Next Page   (BM-/(B Last Line<NL>(B File: webserver.c  (Breturn(B retval;<NL>(BG(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify      (B^C(B Cur Pos      (B^Y(B Prev Page    (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page    (BM-/(B Last Line<NL>78char(B hdrval[1024]; (B// temporary return value(Bmemcpy((char(B *)hdrval%% hdrptr%% (hdrend - hdrptr));hdrval[hdrend - hdrptr] = (B'\0'(B; (B// tack null onto end of header value(Bint(B hdrvallen = strlen(hdrval);retval = (char(B *)malloc((hdrvallen + 1) * sizeof(B(char(B)); (B// malloc a space for retval(Bstrcpy(retval%% (char(B *)hdrval);} (Belse(B {retval = (char(B *)malloc((strlen(hdrptr) + 1) * sizeof(B(char(B)); (B//(Bstrcpy(retval%% hdrptr);}return(B retval;<NL>(B/* As long as str begins with a proper HTTP-Version followed by delim%% returns a(B<NL>(B   pointer to the start of the version number (e.g.%% 1.0). Returns NULL otherwise.<NL> */(B<NL>char(B *http_version_str(char(B *str%% char(B *delim) {char(B *vstart = strstr(str%% (B"HTTP/"(B);char(B *vnumstart = str + 5;char(B *vdot = strchr(str%% (B'.'(B);char(B *vend = strstr(str%% delim);char(B *digits = (B"0123456789"(B;int(B majvlen = 0;int(B minvlen = 0;(Bif(B (!vstart || !vdot (B// something's missing<NL>(B78|| vstart != str) (B// str doesn't start with "HTTP/"(Breturn(B (BNULL(B;majvlen = strspn(vnumstart%% digits);minvlen = strspn(vdot + 1%% digits);(Bif(B (majvlen < 1 || (vnumstart + majvlen) != vdot (B// bad major version(B|| minvlen < 1 || (vdot + minvlen + 1) != vend) (B// bad minor version(Breturn(B (BNULL(B;return(B vnumstart;<NL>(B/* Fills req with the request data from datastr. Returns 0 on success.<NL> */<NL>(B *<NL><NL><NL><NL><NL>78<NL>int(B parsereq(httpreq_t *req%% char(B *datastr) {char(B *position;char(B *last_position = datastr;char(B *temp_position;int(B matchlen;req->method = (B""(B;req->uri = (B""(B;req->version = (B""(B;req->headers = (B""(B;(Bif(B (!(position = strchr(last_position%% (B' '(B))) {return(B 1;}<NL><NL><NL><NL><NL><NL>}78<NL>matchlen = (int(B)(position - last_position);req->method = (char(B *)malloc((matchlen + 1) * sizeof(B(char(B));memcpy(req->method%% last_position%% matchlen);req->method[matchlen] = (B'\0'(B;last_position = position + 1;(Bif(B (!(position = strchr(last_position%% (B' '(B))&& !(position = strstr(last_position%% (B"<NL>"(B))) {return(B 1;(B// strip any query string out of the URIif(B ((temp_position = strchr(last_position%% (B'?'(B)) && temp_position < position)matchlen = (int(B)(temp_position - last_position);(Belse(B<NL><NL><NL><NL><NL>}<NL>78<NL>matchlen = (int(B)(position - last_position);req->uri = (char(B *)malloc((matchlen + 1) * sizeof(B(char(B));memcpy(req->uri%% last_position%% matchlen);req->uri[matchlen] = (B'\0'(B;(Bif(B (position[0] == (B'<NL>'(B) {req->version = (B"0.9"(B;req->headers = (B""(B;return(B 0; (B// simple req -- uri only(B(B// If we get here%% it's a full request%% get the HTTP version and headers(Blast_position = position + 1;(Bif(B (!(position = strstr(last_position%% (B"<NL>"(B))<NL>}<NL><NL>78<NL>|| !(last_position = http_version_str(last_position%% (B"<NL>"(B))) {return(B 1;matchlen = (int(B)(position - last_position);req->version = (char(B *)malloc((matchlen + 1) * sizeof(B(char(B));memcpy(req->version%% last_position%% matchlen);req->version[matchlen] = (B'\0'(B;last_position = position;req->headers = (char(B *)malloc(strlen(last_position) * sizeof(B(char(B));strcpy(req->headers%% last_position);return(B 0;<NL>} (B}<NL><NL><NL>78<NL>char(B *contype(char(B *ext) {(Bif(B (strcmp(ext%% (B"html"(B) == 0) return(B (B"text/html"(B;(Belse(B (Bif(B (strcmp(ext%% (B"htm"(B) == 0) return(B (B"text/html"(B;(Belse(B (Bif(B (strcmp(ext%% (B"jpeg"(B) == 0) return(B (B"image/jpeg"(B;(Belse(B (Bif(B (strcmp(ext%% (B"jpg"(B) == 0) return(B (B"image/jpeg"(B;(Belse(B (Bif(B (strcmp(ext%% (B"gif"(B) == 0) return(B (B"image/gif"(B;(Belse(B (Bif(B (strcmp(ext%% (B"txt"(B) == 0) return(B (B"text/plain"(B;(Belse(B return(B (B"application/octet-stream"(B;<NL>char(B *status(int(B statcode) {(Bif(B (statcode == 200)    return(B (B"200 OK"(B;(Belse(B (Bif(B (statcode == 304) return(B (B"304 Not Modified"(B;<NL><NL>78<NL>(Belse(B (Bif(B (statcode == 400) return(B (B"400 Bad Request"(B;(Belse(B (Bif(B (statcode == 403) return(B (B"403 Forbidden"(B;(Belse(B (Bif(B (statcode == 404) return(B (B"404 Not Found"(B;(Belse(B (Bif(B (statcode == 500) return(B (B"500 Internal Server Error"(B;(Belse(B (Bif(B (statcode == 501) return(B (B"501 Not Implemented"(B;(Belse(B return(B (B""(B;<NL>int(B send_response(int(B sockfd%% httpreq_t *req%% int(B statcode) {int(B urifd;const(B int(B (BBUFSIZE(B = 1024;char(B sendmessage[(BBUFSIZE(B];char(B *path = req->uri;(Bif(B (req->uri == (BNULL(B || req->method == (BNULL(B || (B<NL><NL>78<NL>req->headers == (BNULL(B || req->version == (BNULL(B) {return(B 0;(Bif(B ((path[0] == (B'/'(B) || ((strstr(path%% (B"http://") == path)(B&& (path = strchr(path + 7%%  (B'/'(B)))) {path += 1; (B// remove leading slashif(B (path[0] == (B'\0'(B) {  (B// substituting in index.html for a blank URL!(Bpath = (B"index.html"(B;} (Belse(B (Bif(B (path[strlen(path) - 1] == (B'/'(B) {(B//concatenating index.html for a /-terminated URL!(Bstrcat(path%% (B"index.html"(B);    (B}} (Belse(B {<NL><NL>}<NL>78<NL>statcode = 400;(Bif(B (statcode == 200 && (urifd = open(path%% (BO_RDONLY(B%% 0)) < 0) {(Bif(B (errno == (BENOENT(B || errno == (BENOTDIR(B) { (B// file or directory doesn't exist(Bstatcode = 404;} (Belse(B (Bif(B (errno == (BEACCES(B) { (B// access denied(Bstatcode = 403;} (Belse(B {(B// some other file access problem(Bstatcode = 500;}(Bif(B (strstr(path%% (B".."(B) != (BNULL(B) {}<NL><NL>}<NL>}<NL>78<NL>statcode = 500;sendmessage[0] = (B'\0'(B;(Bif(B (strcmp(req->version%% (B"0.9"(B) != 0) { (B// full request(Bchar(B *ext; (B// file extension(Btime_t curtime;char(B *imstime;struct(B tm tm;struct(B stat stbuf;(Bif(B (statcode == 200) {(Bif(B (ext = strrchr(path%% (B'.'(B)) ext++; (B// skip the '.'(B}<NL>}<NL><NL>78<NL>(Belse(B ext = (B""(B;} (Belse(B {(B// errors are always html messages(Bext = (B"html"(B;(B// Conditional GETif(B ((strcmp(req->method%% (B"GET"(B) == 0)&& (statcode == 200)&& (imstime = get_header(req%% (B"If-Modified-Since"(B))) {(B// Get statistics about the requested URI from the local filesystemif(B (stat(path%% &stbuf) == -1) {statcode = 500;}<NL><NL>78<NL>(Bif(B (!strptime(imstime%% (B"%%a%% %%d %%b %%Y %%H:%%M:%%S GMT"(B%% &tm)&& !strptime(imstime%% (B"%%a%% %%d-%%b-%%y %%H:%%M:%%S GMT"(B%% &tm)&& !strptime(imstime%% (B"%%a %%b %%d %%H:%%M:%%S %%Y"(B%% &tm)) {(B// badly formatted date(Bstatcode = 400;(Bif(B (stbuf.st_mtime <= my_timegm(&tm)) {(B// Not Modified(Bstatcode = 304;}time(&curtime); (B// time for Date: header<NL>(B<NL><NL>78<NL>strcat(sendmessage%% (B"HTTP/1.0 "(B);strcat(sendmessage%% status(statcode));    (Bstrcat(sendmessage%% (B"<NL>Date: "(B);strncat(sendmessage%% asctime(gmtime(&curtime))%% 24);strcat(sendmessage%% (B"<NL>Server: Frobozz Magic Software Company Webserver v.002"(B);strcat(sendmessage%% (B"<NL>Connection: close"(B);strcat(sendmessage%% (B"<NL>Content-Type: "(B);    (Bstrcat(sendmessage%% contype(ext));strcat(sendmessage%% (B"<NL><NL>"(B);(Bif(B (statcode != 200) {strcat(sendmessage%% (B"<html><head><title>"(B);strcat(sendmessage%% status(statcode));<NL><NL>strcat(sendmessage%% status(statcode));    (Bstrcat(sendmessage%% (B"<NL>Date: "(B);strncat(sendmessage%% asctime(gmtime(&curtime))%% 24);strcat(sendmessage%% (B"<NL>Server: Frobozz Magic Software Company Webserver v.002"(B);strcat(sendmessage%% (B"<NL>Connection: close"(B);strcat(sendmessage%% (B"<NL>Content-Type: "(B);    (Bstrcat(sendmessage%% contype(ext));strcat(sendmessage%% (B"<NL><NL>"(B);<NL>}<NL>(Bif(B (statcode != 200) {strcat(sendmessage%% (B"<html><head><title>"(B);strcat(sendmessage%% status(statcode));(B</title></head><body><h2>HTTP/1.0</h2><h1>"(B);(B</h1><h2>URI: "(B);cat(sendmessage%% path);(B</h2></body></html>"(B);}<NL>(Bif(B (sendmessage[0] != (B'\0'(B) {(B// send headers as long as there are headers to sendif(B (send(sockfd%% sendmessage%% strlen(sendmessage)%% 0) < 0) { perror((B"send"(B);pthread_exit((BNULL(B); }}<NL>}<NL>}<NL>78(Bif(B (statcode == 200 && (strcmp(req->method%% (B"HEAD"(B) != 0)) {(B// send the requested file as long as there's no error and the// request wasn't just for the headers(Bint(B readbytes;(Bwhile(B (readbytes = read(urifd%% sendmessage%% (BBUFSIZE(B)) {(Bif(B (readbytes < 0) {perror((B"read"(B);pthread_exit((BNULL(B);(Bif(B (send(sockfd%% sendmessage%% readbytes%% 0) < 0) {perror((B"send"(B);pthread_exit((BNULL(B);}}<NL>78<NL>}<NL>void(B *data_thread(void(B *sockfd_ptr) {int(B sockfd = *(int(B *) sockfd_ptr;const(B int(B (BBUFSIZE(B = 5;char(B recvmessage[(BBUFSIZE(B];char(B *headerstr = (BNULL(B;char(B *newheaderstr = (BNULL(B;int(B recvbytes = 0;int(B curheadlen = 0;int(B totalheadlen = 0;httpreq_t req;int(B statcode = 200;<NL><NL>78<NL>int(B done = 0;int(B seen_header = 0;char(B *header_end;int(B content_length = 0;char(B *qstr;free(sockfd_ptr); (B// we have the int value out of this now(Brecvmessage[(BBUFSIZE(B - 1] = (B'\0'(B; (B// mark end of "string"/* Read incoming client message from the socket */(B  (Bwhile(B(!done && (recvbytes = recv(sockfd%% recvmessage%% (BBUFSIZE(B - 1%% 0))) {(Bif(B (recvbytes < 0) {perror((B"recv"(B);pthread_exit((BNULL(B);}<NL><NL>78<NL>recvmessage[recvbytes] = (B'\0'(B;(Bif(B (seen_header) {(B// getting the entity body(Bcontent_length -= recvbytes;(Bif(B (content_length <= 0) done = 1;} (Belse(B {newheaderstr = (char(B *) malloc((totalheadlen + recvbytes + 1) * sizeof(B(char(B));newheaderstr[totalheadlen + recvbytes] = (B'\0'(B;memcpy(newheaderstr%% headerstr%% totalheadlen);memcpy(newheaderstr + totalheadlen%% recvmessage%% recvbytes);<NL><NL><NL><NL>78<NL>(Bif(B (headerstr != (BNULL(B) {free(headerstr);headerstr = newheaderstr;totalheadlen += recvbytes;header_end = strstr(headerstr%% (B"<NL><NL>"(B);(Bif(B (header_end) {seen_header = 1;header_end[2] = (B'\0'(B;(Bif(B (parsereq(&req%% headerstr) != 0) {<NL><NL><NL><NL><NL>78<NL>statcode = 400;(Bif(B (strcmp(req.method%% (B"POST"(B) == 0) {(B// grab the body length(Bchar(B *clenstr = get_header(&req%% (B"Content-Length"(B);(Bif(B (clenstr) {content_length = atoi(clenstr) - ((headerstr + totalheadlen) - header_end - 4);(Bif(B (content_length <= 0) {done = 1;}<NL><NL><NL><NL><NL>78<NL>free(clenstr);} (Belse(B {statcode = 400; (B// bad request -- no content length(Bdone = 1;}} (Belse(B {(B// This isn't a POST%% so there's no entity body(Bdone = 1;(Bif(B (strcmp(req.method%% (B"GET"(B) != 0<NL><NL><NL><NL><NL><NL>78<NL>&& strcmp(req.method%% (B"HEAD"(B) != 0) {statcode = 501; (B// unknown request method(B}}} (B// end of "if (header)end)"(B}} (B// end of recv while loop// used to deref a NULL pointer here... :(if(B (headerstr != (BNULL(B) {printf((B"%%s<NL>"(B%% headerstr);free(headerstr);}<NL><NL><NL>}78<NL>send_response(sockfd%% &req%% statcode);close(sockfd);return(B (BNULL(B;<NL>int(B main(int(B argc%% char(B *argv[]) {int(B acc%% sockfd%% clen%% port;struct(B hostent *he;struct(B sockaddr_in caddr%% saddr;(Bif(B(argc <= 1) {<NL><NL><NL><NL><NL><NL><NL>78fprintf(stderr%% (B"No port specified. Exiting!<NL>"(B);exit(1);port = atoi(argv[1]);(B/* Obtain name and address for the local host */if(B((he=gethostbyname((B"localhost"(B))==(BNULL(B) {herror((B"gethostbyname"(B);exit(1);}<NL><NL><NL><NL><NL><NL><NL><NL>78(B/* Open a TCP (Internet Stream) socket */if(B((sockfd=socket((BAF_INET(B%%(BSOCK_STREAM(B%%0)) == -1) {perror((B"socket"(B);exit(1);(B/* Create socket address structure for the local host */(Bmemset((char(B *) &saddr%% (B'\0'(B%% sizeof(B(saddr));saddr.sin_family=(BAF_INET(B;saddr.sin_port=htons(port);saddr.sin_addr.s_addr=htonl((BINADDR_ANY(B);(B/* Bind our local address so that the client can send to us */(B<NL><NL><NL><NL>78<NL>(Bif(B(bind(sockfd%%(struct(B sockaddr *) &saddr%%sizeof(B(saddr)) == -1) {  (Bperror((B"bind"(B);exit(1);(Bif(B(listen(sockfd%%5) < 0) {perror((B"listen"(B);exit(1);(B/* Infinite loop for receiving and processing client requests */for(B(;;) clen=sizeof(B(caddr);(B/* Wait for a connection for a client process */(B}<NL>}<NL><NL>78<NL>acc=accept(sockfd%%(struct(B sockaddr *) &caddr%%(socklen_t*)&clen);(Bif(B(acc < 0) {perror((B"accept"(B);exit(1);} (Belse(B {pthread_t *thread = (pthread_t *) malloc(sizeof(B(pthread_t));int(B *sockfd_ptr = (int(B *) malloc(sizeof(B(int(B));*sockfd_ptr = acc;pthread_create(thread%% (BNULL(B%% data_thread%% sockfd_ptr);}return(B 0;<NL>}<NL>;;{<NL><NL>}<NL><NL>}7}<NL><NL>perror((B"bind"(B);exit(1);(Bif(B(listen(sockfd%%5) < 0) {perror((B"listen"(B);exit(1);(B/* Infinite loop for receiving and processing client requests */for(B(;;) clen=sizeof(B(caddr);(B/* Wait for a connection for a client process */(Bacc=accept(sockfd%%(struct(B sockaddr *) &caddr%%(socklen_t*)&clen);(BModified(Biqf(acc < 0)(Bif(<NL>(BSave modified buffer (ANSWERING "No" WILL DESTROY CHANGES) ?                                                                      Y(B Yes<NL>(B N(B No  (BC(B Cancel<NL>%,sudo nano webserver.c
CMBEGIN,,,wget http://localhost:8080/lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll ,%lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>ll<NL>--2018-11-28 12:22:29--  http://localhost:8080/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8080... connected.<NL>HTTP request sent%% awaiting response... 404 Not Found<NL>2018-11-28 12:22:29 ERROR 404: Not Found.<NL>%,
CMBEGIN,,,wget http://localhost:8080/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll,%llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>The name is too long%% 300 chars total.<NL>Trying to shorten...<NL>New name is llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll.<NL>--2018-11-28 12:22:35--  http://localhost:8080/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8080... connected.<NL>HTTP request sent%% awaiting response... 500 Internal Server Error<NL>2018-11-28 12:22:35 ERROR 500: Internal Server Error.<NL>%,
CMBEGIN,,,wget http://localhost:8080/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll,%llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>The name is too long%% 700 chars total.<NL>Trying to shorten...<NL>New name is llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll.<NL>--2018-11-28 12:22:46--  http://localhost:8080/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8080... connected.<NL>HTTP request sent%% awaiting response... 500 Internal Server Error<NL>2018-11-28 12:22:46 ERROR 500: Internal Server Error.<NL>%,
CMBEGIN,,,wget http://localhost:8080/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll,llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A,
CMBEGIN,,,wget http://localhost:8080/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll,%llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll <NL>lllllllllllllllllllllllll<NL>The name is too long%% 1900 chars total.<NL>Trying to shorten...<NL>New name is llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll.<NL>--2018-11-28 12:23:00--  http://localhost:8080/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8080... connected.<NL>HTTP request sent%% awaiting response... No data received.<NL>Retrying.<NL><NL>--2018-11-28 12:23:03--  (try: 2)  http://localhost:8080/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>Connecting to localhost (localhost)|127.0.0.1|:8080... failed: Connection refused.<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8080... failed: Connection refused.%,
CMBEGIN,Nov 28 12:23:50,/usr/src/fhttpd,gdb ./webserver,%GNU gdb (Ubuntu 7.11.1-0ubuntu1~16.04) 7.11.1<NL>Copyright (C) 2016 Free Software Foundation%% Inc.<NL>License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html><NL>This is free software: you are free to change and redistribute it.<NL>There is NO WARRANTY%% to the extent permitted by law.  Type \"show copying\"<NL>and \"show warranty\" for details.<NL>This GDB was configured as \"x86_64-linux-gnu\".<NL>Type \"show configuration\" for configuration details.<NL>For bug reporting instructions%% please see:<NL><http://www.gnu.org/software/gdb/bugs/>.<NL>Find the GDB manual and other documentation resources online at:<NL><http://www.gnu.org/software/gdb/documentation/>.<NL>For help%% type \"help\".<NL>Type \"apropos word\" to search for commands related to \"word\"...<NL>Reading symbols from ./webserver...done.<NL>(gdb) exit<NL>Undefined command: \"exit\".  Try \"help\".<NL>(gdb) quit%,gdb ./webserver
CMBEGIN,,,wget http://localhost:8080/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll,%llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>lllllllllllllllllllllllll<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[Allllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[Allllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>lllllllllllllllllllllllll<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[Afhttpd$ wget http://localhost:8080<BS>/l<NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL>llllllllllllllllllllllll<ESC>[K<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A/fhttpd$ wget http://localhost:8081/<NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL>lllllllllllllllllllllllll<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[Afhttpd$ wget http://localhost:8081<NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL>The name is too long%% 1900 chars total.<NL>Trying to shorten...<NL>New name is llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll.<NL>--2018-11-28 12:25:01--  http://localhost:8081/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8081... connected.<NL>HTTP request sent%% awaiting response... No data received.<NL>Retrying.<NL><NL>--2018-11-28 12:25:02--  (try: 2)  http://localhost:8081/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>Connecting to localhost (localhost)|127.0.0.1|:8081... failed: Connection refused.<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8081... failed: Connection refused.%,
CMBEGIN,Nov 28 12:25:32,/usr/src/fhttpd,nano webserver.c,%(B===(B(B[ Error writing lock file ./.webserver.c.swp: Permission denied ]<NL>(B (B[ Reading File ](B<NL>(B[ Read 519 lines (Warning: No write permission) ]<NL>(B(B  GNU nano 2.5.3                              File: webserver.c                                                                  (B// webserver.c<NL>// FrobozzCo Official Webserver<NL>// Barbazzo Fernap barbazzo@gue.com<NL>// Gustar Woomax gustar@gue.com<NL>// Wilbar Memboob wilbar@gue.com<NL>// By the Frobozz Magic Webserver Company<NL>// Released under the Grue Public License<NL>// Frobruary 14th%% 1067 GUE<NL>// THERE IS NO WARRANTY FOR THE PROGRAM%% TO THE EXTENT PERMITTED<NL>// BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE(B <NL>(B// COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM <C3><CENT>^<C3><EURO>^<C3><L_OE>AS IS<C3><CENT>^<C3><EURO>^<C3><9D>(B <NL>(B// WITHOUT WARRANTY OF ANY KIND%% EITHER EXPRESSED OR IMPLIED%% INCLUDING%%(B <NL>(B// BUT NOT LIMITED TO%% THE IMPLIED WARRANTIES OF MERCHANTABILITY AND(B <NL>(B// FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY(B <NL>(B// AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE(B <NL>(B// DEFECTIVE%% *AND IT WILL*%% YOU ASSUME THE COST OF ALL NECESSARY(B <NL>(B// SERVICING%% REPAIR OR CORRECTION.<NL>#include(B (B<stdio.h><NL>#include(B (B<errno.h><NL>#include(B (B<string.h><NL>#include(B (B<stdlib.h><NL>#include(B (B<netdb.h><NL>#include(B (B<sys/stat.h><NL>#include(B (B<sys/types.h><NL>#include(B (B<sys/socket.h><NL>#include(B (B<netinet/in.h><NL>(B^G(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos(B^Y(B Prev Page    (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page    (BM-/(B Last Line<NL>78(B#include(B (B<arpa/inet.h><NL>#include(B (B<unistd.h><NL>#include(B (B<fcntl.h><NL>#include(B (B<time.h><NL>#include(B (B<pthread.h><NL>#define(B (B_XOPEN_SOURCE<NL>(Btypedef(B struct(B {char(B *method;char(B *uri;char(B *version;char(B *headers;<NL>} httpreq_t;<NL>78(B/* NOTE: this function is based on a function provided in the GNU "timegm" man<NL>   page. timegm is a GNU extension to time.h that returns the given tm struct as<NL>   a UNIX timestamp in GMT/UTC%% rather than local time. The man page suggests a<NL>   function similar to the one below as a portable equivalent.<NL> */<NL>(Btime_t my_timegm(struct(B tm *tm) {time_t ret;char(B *tz;tz = getenv((B"TZ"(B);putenv((B"TZ=GMT"(B);tzset();ret = mktime(tm);(Bif(B (tz) {<NL>(BModified[ Warning: Modifying a file which is not locked%% check directory permission? ]<NL>(B(B_3(B(B1(B(B4(B78<NL>M<NL>(Bif(B (tz)<NL>(BEnter line number%% column number:                                                                                                (B(B^Y(B First Line      (B^T(B Go To Text(BC(B Cancel(B^V(B(B3(B(B1(B(B4(B strcat(sendmessage%% (B"<NL>Connection: close"(B); strcat(sendmessage%% (B"<NL>Content-Type: "(B);    (B strcat(sendmessage%% contype(ext)); strcat(sendmessage%% (B"<NL><NL>"(B); (Bif(B (statcode != 200) { strcat(sendmessage%% (B"<html><head><title>"(B); strcat(sendmessage%% status(statcode)); strcat(sendmessage%% (B"</title></head><body><h2>HTTP/1.0</h2><h1>"(B); strcat(sendmessage%% status(statcode)); strcat(sendmessage%% (B"</h1><h2>URI: "(B);strcat(sendmessage%% path);strcat(sendmessage%% (B"</h2></body></html>"(B); }<NL> (Bif(B (sendmessage[0] != (B'\0'(B) { (B// send headers as long as there are headers to send(B (Bif(B (send(sockfd%% sendmessage%% strlen(sendmessage)%% 0) < 0) { perror((B"send"(B); pthread_exit((BNULL(B); }}<NL>(Bif(B (statcode == 200 && (strcmp(req->method%% (B"HEAD"(B) != 0)) { (B// send the requested file as long as there's no error and the(B (B// request wasn't just for the headers(B int(B readbytes;<NL>(B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos      (B^Y(B Prev Page    (BM-\(B First Line(BX(B Exit  (B^R(B Read File    (B^\(B Replace      (B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page    (BM-/(B Last Line<NL>strcat(sendmessage%% <NL><NL>statcode = 400;(Bif(B (stbuf.st_mtime <= my_timegm(&tm)) {(B// Not Modified(Bstatcode = 304;}time(&curtime); (B// time for Date: header(Bstrcat(sendmessage%% (B"HTTP/1.0 "(B);strcat(sendmessage%% status(statcode));    (Bstrcat(sendmessage%% (B"<NL>Date: "(B);strncat(sendmessage%% asctime(gmtime(&curtime))%% 24);strcat(sendmessage%% (B"<NL>Server: Frobozz Magic Software Company Webserver v.002"(B);<NL><NL>(B// Conditional GETif(B ((strcmp(req->method%% (B"GET"(B) == 0)&& (statcode == 200)&& (imstime = get_header(req%% (B"If-Modified-Since"(B))) {(B// Get statistics about the requested URI from the local filesystemif(B (stat(path%% &stbuf) == -1) {statcode = 500;(Bif(B (!strptime(imstime%% (B"%%a%% %%d %%b %%Y %%H:%%M:%%S GMT"(B%% &tm)&& !strptime(imstime%% (B"%%a%% %%d-%%b-%%y %%H:%%M:%%S GMT"(B%% &tm)&& !strptime(imstime%% (B"%%a %%b %%d %%H:%%M:%%S %%Y"(B%% &tm)) {(B// badly formatted date(B<NL><NL><NL>(Bif(B (strcmp(req->version%% (B"0.9"(B) != 0) { (B// full request(Bchar(B *ext; (B// file extension(Btime_t curtime;char(B *imstime;struct(B tm tm;struct(B stat stbuf;<NL>(Bif(B (statcode == 200) {(Bif(B (ext = strrchr(path%% (B'.'(B)) ext++; (B// skip the '.'else(B ext = (B""(B;} (Belse(B {(B// errors are always html messages(Bext = (B"html"(B;}<NL>(B// Conditional GETif(B ((strcmp(req->method%% (B"GET"(B) == 0)&& (statcode == 200)&& (imstime = get_header(req%% (B"If-Modified-Since"(B))) {<NL>(B// Get statistics about the requested URI from the local filesystem(B (Bif(B (stat(path%% &stbuf) == -1) {statcode = 500; }<NL> (Bif(B (!strptime(imstime%% (B"%%a%% %%d %%b %%Y %%H:%%M:%%S GMT"(B%% &tm) && !strptime(imstime%% (B"%%a%% %%d-%%b-%%y %%H:%%M:%%S GMT"(B%% &tm) && !strptime(imstime%% (B"%%a %%b %%d %%H:%%M:%%S %%Y"(B%% &tm)) {<NL>;;<NL>(BEnter line number%% column number:                                                                                                (B(B^Y(B First Line      (B^T(B Go To Text(BC(B Cancel(B^V(B(B2(B(B1(B(B3(B<NL>char(B *status(int(B statcode) {(Bif(B (statcode == 200)    return(B (B"200 OK"(B;(Belse(B (Bif(B (statcode == 304) return(B (B"304 Not Modified"(B;(Belse(B (Bif(B (statcode == 400) return(B (B"400 Bad Request"(B;(Belse(B (Bif(B (statcode == 403) return(B (B"403 Forbidden"(B;(Belse(B (Bif(B (statcode == 404) return(B (B"404 Not Found"(B;(Belse(B (Bif(B (statcode == 500) return(B (B"500 Internal Server Error"(B;(Belse(B (Bif(B (statcode == 501) return(B (B"501 Not Implemented"(B;(Belse(B return(B (B""(B;<NL>int(B send_response(int(B sockfd%% httpreq_t *req%% int(B statcode) {int(B urifd;const(B int(B (BBUFSIZE(B = 1024;char(B sendmessage[(BBUFSIZE(B];char(B *path = req->uri;<NL>(Bif(B (req->uri == (BNULL(B || req->method == (BNULL(B || (Breq->headers == (BNULL(B || req->version == (BNULL(B) {return(B 0;}<NL>(Bif(B ((path[0] == (B'/'(B) || ((strstr(path%% (B"http://") == path)(B && (path = strchr(path + 7%%  (B'/'(B)))) {path += 1; (B// remove leading slash(B<NL>(B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos      (B^Y(B Prev Page    (BM-\(B First Line(BX(B Exit  (B^R(B Read File    (B^\(B Replace      (B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page    (BM-/(B Last Line<NL>; = 1<NL>(BSave modified buffer (ANSWERING "No" WILL DESTROY CHANGES) ?                                                                      Y(B Yes<NL>(B N(B No  (BC(B Cancel<NL>(BFile Name to Write: webserver.c                             <NL>^G(B Get Help(BM-D(B DOS Format(BM-A(B Append(BM-B(B Backup File<NL>(B^C(B Cancel         (BM-M(B Mac Format(BM-P(B Prepend(B^T(B To Files (B[ Error writing webserver.c: Permission denied ](B(B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify      (B^C(B Cur Pos(B^Y(B Prev Page    (BM-\(B First Line(BX(B Exit  (B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page    (BM-/(B Last Line<NL>(BSave modified buffer (ANSWERING "No" WILL DESTROY CHANGES) ?                                                                      Y(B Yes<NL>(B N(B No  (BC(B Cancel<NL>%,nano webserver.c
CMBEGIN,,,sudo ,%<ESC>[?1049h<ESC>[1;34r<ESC>(B<ESC>[m<ESC>[4l<ESC>[?7h<ESC>[?1h<ESC>=<ESC>[?1h<ESC>=<ESC>[?1h<ESC>=<ESC>[39;49m<ESC>[?25l<ESC>[39;49m<ESC>(B<ESC>[m<ESC>[H<ESC>[2J<ESC>[32;57H<ESC>(B<ESC>[0;7m[ Reading File ]<NL><ESC>[3d<ESC>(B<ESC>[m<ESC>[32;56H<ESC>(B<ESC>[0;7m[ Read 519 lines ]<NL><ESC>[3d<ESC>(B<ESC>[m<ESC>[?12l<ESC>[?25h<ESC>[H<ESC>[39;49m<ESC>(B<ESC>[0;7m  GNU nano 2.5.3                              File: webserver.c                                                                  <ESC>[3;1H<ESC>(B<ESC>[0;1m<ESC>[34m// webserver.c<NL><ESC>[4d// FrobozzCo Official Webserver<NL><ESC>[5d// Barbazzo Fernap barbazzo@gue.com<NL><ESC>[6d// Gustar Woomax gustar@gue.com<NL><ESC>[7d// Wilbar Memboob wilbar@gue.com<NL><ESC>[9d// By the Frobozz Magic Webserver Company<NL><ESC>[10d// Released under the Grue Public License<NL><ESC>[11d// Frobruary 14th%% 1067 GUE<NL><ESC>[13d// THERE IS NO WARRANTY FOR THE PROGRAM%% TO THE EXTENT PERMITTED<NL><ESC>[14d// BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE<ESC>(B<ESC>[0m<ESC>[42m <NL><ESC>[15d<ESC>(B<ESC>[0;1m<ESC>[34m// COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM <C3><CENT>^<C3><EURO>^<C3><L_OE>AS IS<C3><CENT>^<C3><EURO>^<C3><9D><ESC>(B<ESC>[0m<ESC>[42m <NL><ESC>[16d<ESC>(B<ESC>[0;1m<ESC>[34m// WITHOUT WARRANTY OF ANY KIND%% EITHER EXPRESSED OR IMPLIED%% INCLUDING%%<ESC>(B<ESC>[0m<ESC>[42m <NL><ESC>[17d<ESC>(B<ESC>[0;1m<ESC>[34m// BUT NOT LIMITED TO%% THE IMPLIED WARRANTIES OF MERCHANTABILITY AND<ESC>(B<ESC>[0m<ESC>[42m <NL><ESC>[18d<ESC>(B<ESC>[0;1m<ESC>[34m// FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY<ESC>(B<ESC>[0m<ESC>[42m <NL><ESC>[19d<ESC>(B<ESC>[0;1m<ESC>[34m// AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE<ESC>(B<ESC>[0m<ESC>[42m <NL><ESC>[20d<ESC>(B<ESC>[0;1m<ESC>[34m// DEFECTIVE%% *AND IT WILL*%% YOU ASSUME THE COST OF ALL NECESSARY<ESC>(B<ESC>[0m<ESC>[42m <NL><ESC>[21d<ESC>(B<ESC>[0;1m<ESC>[34m// SERVICING%% REPAIR OR CORRECTION.<NL><ESC>[23d<ESC>[36m#include<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m<stdio.h><NL><ESC>[24d<ESC>[36m#include<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m<errno.h><NL><ESC>[25d<ESC>[36m#include<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m<string.h><NL><ESC>[26d<ESC>[36m#include<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m<stdlib.h><NL><ESC>[27d<ESC>[36m#include<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m<netdb.h><NL><ESC>[28d<ESC>[36m#include<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m<sys/stat.h><NL><ESC>[29d<ESC>[36m#include<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m<sys/types.h><NL><ESC>[30d<ESC>[36m#include<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m<sys/socket.h><NL><ESC>[31d<ESC>[36m#include<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m<netinet/in.h><NL><ESC>[33d<ESC>[39m<ESC>(B<ESC>[0;7m^G<ESC>(B<ESC>[m Get Help     <ESC>(B<ESC>[0;7m^O<ESC>(B<ESC>[m Write Out    <ESC>(B<ESC>[0;7m^W<ESC>(B<ESC>[m Where Is     <ESC>(B<ESC>[0;7m^K<ESC>(B<ESC>[m Cut Text     <ESC>(B<ESC>[0;7m^J<ESC>(B<ESC>[m Justify<ESC>[81G<ESC>(B<ESC>[0;7m^C<ESC>(B<ESC>[m Cur Pos<ESC>[97G<ESC>(B<ESC>[0;7m^Y<ESC>(B<ESC>[m Prev Page    <ESC>(B<ESC>[0;7mM-\<ESC>(B<ESC>[m First Line<NL><ESC>[34d<ESC>(B<ESC>[0;7m^X<ESC>(B<ESC>[m Exit<ESC>[34;17H<ESC>(B<ESC>[0;7m^R<ESC>(B<ESC>[m Read File    <ESC>(B<ESC>[0;7m^\<ESC>(B<ESC>[m Replace<ESC>[49G<ESC>(B<ESC>[0;7m^U<ESC>(B<ESC>[m Uncut Text   <ESC>(B<ESC>[0;7m^T<ESC>(B<ESC>[m To Spell     <ESC>(B<ESC>[0;7m^_<ESC>(B<ESC>[m Go To Line   <ESC>(B<ESC>[0;7m^V<ESC>(B<ESC>[m Next Page    <ESC>(B<ESC>[0;7mM-/<ESC>(B<ESC>[m Last Line<NL><ESC>[3d<ESC>[32d<ESC>(B<ESC>[0;7mEnter line number%% column number:                                                                                                <ESC>[33;17H<ESC>(B<ESC>[m<ESC>[27X<ESC>[33;44H<ESC>(B<ESC>[0;7m^Y<ESC>(B<ESC>[m First Line<ESC>[18X<ESC>[33;81H      <ESC>(B<ESC>[0;7m^T<ESC>(B<ESC>[m Go To Text<ESC>[K<ESC>[34;2H<ESC>(B<ESC>[0;7mC<ESC>(B<ESC>[m Cancel<ESC>[17G<ESC>[27X<ESC>[34;44H<ESC>(B<ESC>[0;7m^V<ESC>(B<ESC>[m<ESC>[70P<ESC>[32;35H<ESC>(B<ESC>[0;7m2<ESC>(B<ESC>[m<ESC>(B<ESC>[0;7m1<ESC>(B<ESC>[m<ESC>(B<ESC>[0;7m3<ESC>(B<ESC>[m<NL><ESC>[3d<ESC>[K<ESC>[4d}<ESC>[K<ESC>[5d<BS><ESC>[K<ESC>[6d<ESC>[32mchar<ESC>[39m<ESC>(B<ESC>[m *status(<ESC>[32mint<ESC>[39m<ESC>(B<ESC>[m statcode) {<ESC>[K<ESC>[7;8H<ESC>[1K <ESC>(B<ESC>[0;1m<ESC>[33mif<ESC>[39m<ESC>(B<ESC>[m (statcode == 200)    <ESC>[35mreturn<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m"200 OK"<ESC>[39m<ESC>(B<ESC>[m;<ESC>[8;9H<ESC>(B<ESC>[0;1m<ESC>[33melse<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33mif<ESC>[39m<ESC>(B<ESC>[m (statcode == 304) <ESC>[35mreturn<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m"304 Not Modified"<ESC>[39m<ESC>(B<ESC>[m;<ESC>[9;8H<ESC>[1K <ESC>(B<ESC>[0;1m<ESC>[33melse<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33mif<ESC>[39m<ESC>(B<ESC>[m (statcode == 400) <ESC>[35mreturn<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m"400 Bad Request"<ESC>[39m<ESC>(B<ESC>[m;<ESC>[10;8H<ESC>[1K <ESC>(B<ESC>[0;1m<ESC>[33melse<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33mif<ESC>[39m<ESC>(B<ESC>[m (statcode == 403) <ESC>[35mreturn<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m"403 Forbidden"<ESC>[39m<ESC>(B<ESC>[m;<ESC>[11;8H<ESC>[1K <ESC>(B<ESC>[0;1m<ESC>[33melse<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33mif<ESC>[39m<ESC>(B<ESC>[m (statcode == 404) <ESC>[35mreturn<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m"404 Not Found"<ESC>[39m<ESC>(B<ESC>[m;<ESC>[12;9H<ESC>(B<ESC>[0;1m<ESC>[33melse<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33mif<ESC>[39m<ESC>(B<ESC>[m (statcode == 500) <ESC>[35mreturn<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m"500 Internal Server Error"<ESC>[39m<ESC>(B<ESC>[m;<ESC>[13;8H<ESC>[1K <ESC>(B<ESC>[0;1m<ESC>[33melse<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33mif<ESC>[39m<ESC>(B<ESC>[m (statcode == 501) <ESC>[35mreturn<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m"501 Not Implemented"<ESC>[39m<ESC>(B<ESC>[m;<ESC>[K<ESC>[14;8H<ESC>[1K <ESC>(B<ESC>[0;1m<ESC>[33melse<ESC>[39m<ESC>(B<ESC>[m <ESC>[35mreturn<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[33m""<ESC>[39m<ESC>(B<ESC>[m;<ESC>[K<NL><ESC>[15d}<ESC>[K<ESC>[16d<BS><ESC>[K<ESC>[17d<ESC>[32mint<ESC>[39m<ESC>(B<ESC>[m send_response(<ESC>[32mint<ESC>[39m<ESC>(B<ESC>[m sockfd%% httpreq_t *req%% <ESC>[32mint<ESC>[39m<ESC>(B<ESC>[m statcode) {<ESC>[K<ESC>[18;8H<ESC>[1K <ESC>[32mint<ESC>[39m<ESC>(B<ESC>[m urifd;<ESC>[K<ESC>[19;8H<ESC>[1K <ESC>[32mconst<ESC>[39m<ESC>(B<ESC>[m <ESC>[32mint<ESC>[39m<ESC>(B<ESC>[m <ESC>(B<ESC>[0;1m<ESC>[31mBUFSIZE<ESC>[39m<ESC>(B<ESC>[m = 1024;<ESC>[K<ESC>[20;8H<ESC>[1K <ESC>[32mchar<ESC>[39m<ESC>(B<ESC>[m sendmessage[<ESC>(B<ESC>[0;1m<ESC>[31mBUFSIZE<ESC>[39m<ESC>(B<ESC>[m];<ESC>[K<ESC>[21;8H<ESC>[1K <ESC>[32mchar<ESC>[39m<ESC>(B<ESC>[m *path = req->uri;<ESC>[K<ESC>[23;8H<ESC>[1K <ESC>(B<ESC>[0;1m<ESC>[33mif<ESC>[39m<ESC>(B<ESC>[m (req->uri == <ESC>(B<ESC>[0;1m<ESC>[31mNULL<ESC>[39m<ESC>(B<ESC>[m || req->method == <ESC>(B<ESC>[0;1m<ESC>[31mNULL<ESC>[39m<ESC>(B<ESC>[m ||<ESC>[42m <ESC>[24;16H<ESC>[49m<ESC>(B<ESC>[m<ESC>[1K req->headers == <ESC>(B<ESC>[0;1m<ESC>[31mNULL<ESC>[39m<ESC>(B<ESC>[m || req->version == <ESC>(B<ESC>[0;1m<ESC>[31mNULL<ESC>[39m<ESC>(B<ESC>[m) {<ESC>[25;16H<ESC>[1K <ESC>[35mreturn<ESC>[39m<ESC>(B<ESC>[m 0;<ESC>[26;8H<ESC>[1K }<ESC>[K<NL><ESC>[27d<ESC>[K<ESC>[28d<ESC>[K<ESC>[29;8H<ESC>[1K <ESC>(B<ESC>[0;1m<ESC>[33mif<ESC>[39m<ESC>(B<ESC>[m ((path[0] == <ESC>(B<ESC>[0;1m<ESC>[35m'/'<ESC>[39m<ESC>(B<ESC>[m) || ((strstr(path%% <ESC>(B<ESC>[0;1m<ESC>[33m"http:<ESC>[34m//") == path)<ESC>[30;57H<ESC>[39m<ESC>(B<ESC>[m<ESC>[1K && (path = strchr(path + 7%%  <ESC>(B<ESC>[0;1m<ESC>[35m'/'<ESC>[39m<ESC>(B<ESC>[m)))) {<ESC>[31;16H<ESC>[1K path += 1; <ESC>(B<ESC>[0;1m<ESC>[34m// remove leading slash<NL><ESC>[32d<ESC>[39m<ESC>(B<ESC>[m<ESC>[K<ESC>[33;17H<ESC>(B<ESC>[0;7m^O<ESC>(B<ESC>[m Write Out    <ESC>(B<ESC>[0;7m^W<ESC>(B<ESC>[m Where Is     <ESC>(B<ESC>[0;7m^K<ESC>(B<ESC>[m Cut Text     <ESC>(B<ESC>[0;7m^J<ESC>(B<ESC>[m Justify<ESC>[81G<ESC>(B<ESC>[0;7m^C<ESC>(B<ESC>[m Cur Pos      <ESC>(B<ESC>[0;7m^Y<ESC>(B<ESC>[m Prev Page    <ESC>(B<ESC>[0;7mM-\<ESC>(B<ESC>[m First Line<ESC>[34;2H<ESC>(B<ESC>[0;7mX<ESC>(B<ESC>[m Exit  <ESC>[17G<ESC>(B<ESC>[0;7m^R<ESC>(B<ESC>[m Read File    <ESC>(B<ESC>[0;7m^\<ESC>(B<ESC>[m Replace      <ESC>(B<ESC>[0;7m^U<ESC>(B<ESC>[m Uncut Text   <ESC>(B<ESC>[0;7m^T<ESC>(B<ESC>[m To Spell     <ESC>(B<ESC>[0;7m^_<ESC>(B<ESC>[m Go To Line   <ESC>(B<ESC>[0;7m^V<ESC>(B<ESC>[m Next Page    <ESC>(B<ESC>[0;7mM-/<ESC>(B<ESC>[m Last Line<NL><ESC>[17d<ESC>[C<ESC>[C<ESC>[C s<NL><ESC>[18d<ESC>[18;9H<ESC>[C<ESC>[19d<ESC>[C<ESC>[C<ESC>[C<ESC>[C <ESC>[C<ESC>[C<ESC>[C <ESC>[C<ESC>[C<ESC>[C<ESC>[C<ESC>[C<ESC>[C<ESC>[C = 1<ESC>[1;120H<ESC>(B<ESC>[0;7mModified<ESC>[19;29H<ESC>(B<ESC>[m024;<ESC>[K<BS><BS><BS><BS>2024;<BS><BS><BS><BS><NL><ESC>[32d<ESC>(B<ESC>[0;7mSave modified buffer (ANSWERING "No" WILL DESTROY CHANGES) ?                                                                     <ESC>[33;1H Y<ESC>(B<ESC>[m Yes<ESC>[K<NL><ESC>[34d<ESC>(B<ESC>[0;7m N<ESC>(B<ESC>[m No  <ESC>[34;18H<ESC>(B<ESC>[0;7mC<ESC>(B<ESC>[m Cancel<ESC>[K<ESC>[32;62H<NL><ESC>(B<ESC>[0;7mFile Name to Write: webserver.c                             <NL><ESC>[33d^G<ESC>(B<ESC>[m Get Help<ESC>[33;26H<ESC>(B<ESC>[0;7mM-D<ESC>(B<ESC>[m DOS Format<ESC>[33;51H<ESC>(B<ESC>[0;7mM-A<ESC>(B<ESC>[m Append<ESC>[33;76H<ESC>(B<ESC>[0;7mM-B<ESC>(B<ESC>[m Backup File<NL><ESC>[34d<ESC>(B<ESC>[0;7m^C<ESC>(B<ESC>[m Cancel<ESC>[17G         <ESC>(B<ESC>[0;7mM-M<ESC>(B<ESC>[m Mac Format<ESC>[34;51H<ESC>(B<ESC>[0;7mM-P<ESC>(B<ESC>[m Prepend<ESC>[34;76H<ESC>(B<ESC>[0;7m^T<ESC>(B<ESC>[m To Files<ESC>[32;32H<ESC>[?25l<ESC>[32;55H<ESC>[39;49m<ESC>(B<ESC>[m<ESC>[1K <ESC>(B<ESC>[0;7m[ Wrote 519 lines ]<ESC>(B<ESC>[m<ESC>[K<ESC>[19;30H<NL><ESC>[32d<ESC>[J<ESC>[1;120H<ESC>(B<ESC>[0;7m        <ESC>[34;129H<ESC>(B<ESC>[m<ESC>[34;1H<ESC>[?12l<ESC>[?25h<ESC>[?1049l%,
CMBEGIN,Nov 28 12:27:53,/usr/src/fhttpd,sudo make,%gcc -D_FORTIFY_SOURCE=0 -frecord-gcc-switches -fno-stack-protector -z execstack -g -o webserver -D_TS_ERRNO webserver.c -lnsl -lresolv -lpthread<NL>webserver.c: In function 'send_response':<NL>webserver.c:281:9: warning: implicit declaration of function 'strptime' [-Wimplicit-function-declaration]<NL>    if (!strptime(imstime%% "%%a%% %%d %%b %%Y %%H:%%M:%%S GMT"%% &tm)<NL>         ^%,sudo make
CMBEGIN,,,wget http://localhost:8081/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll,%llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>lllllllllllllllllllllllll<NL>The name is too long%% 1900 chars total.<NL>Trying to shorten...<NL>New name is llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll.<NL>--2018-11-28 12:28:22--  http://localhost:8081/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8081... failed: Connection refused.%,
CMBEGIN,,,wget http://localhost:8081/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll,%llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>lllllllllllllllllllllllll<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[Afhttpd$ wget http://localhost:8081<BS>/l<NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL>llllllllllllllllllllllll<ESC>[K<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A/fhttpd$ wget http://localhost:8083/<NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL>lllllllllllllllllllllllll<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[Afhttpd$ wget http://localhost:8083<NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL>The name is too long%% 1900 chars total.<NL>Trying to shorten...<NL>New name is llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll.<NL>--2018-11-28 12:28:31--  http://localhost:8083/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>Resolving localhost (localhost)... 127.0.0.1<NL>Connecting to localhost (localhost)|127.0.0.1|:8083... failed: Connection refused.%,
CMBEGIN,,,wget http://localhost:8083/llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll,llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll<NL>lllllllllllllllllllllllll<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[Afhttpd$ wget http://localhost:8081<NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL><NL>lllllllllllllllllllllllll<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[A<ESC>[Afhttpd$ sudo make<ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL><NL><ESC>[K<NL>,
CMBEGIN,Nov 28 12:28:45,/usr/src/fhttpd,sudo nano webserver.c,%(B===(B(B[ Reading File ]<NL>(B(B[ Read 519 lines ]<NL>(B(B  GNU nano 2.5.3                              File: webserver.c                                                                  (B// webserver.c<NL>// FrobozzCo Official Webserver<NL>// Barbazzo Fernap barbazzo@gue.com<NL>// Gustar Woomax gustar@gue.com<NL>// Wilbar Memboob wilbar@gue.com<NL>// By the Frobozz Magic Webserver Company<NL>// Released under the Grue Public License<NL>// Frobruary 14th%% 1067 GUE<NL>// THERE IS NO WARRANTY FOR THE PROGRAM%% TO THE EXTENT PERMITTED<NL>// BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE(B <NL>(B// COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM <C3><CENT>^<C3><EURO>^<C3><L_OE>AS IS<C3><CENT>^<C3><EURO>^<C3><9D>(B <NL>(B// WITHOUT WARRANTY OF ANY KIND%% EITHER EXPRESSED OR IMPLIED%% INCLUDING%%(B <NL>(B// BUT NOT LIMITED TO%% THE IMPLIED WARRANTIES OF MERCHANTABILITY AND(B <NL>(B// FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY(B <NL>(B// AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE(B <NL>(B// DEFECTIVE%% *AND IT WILL*%% YOU ASSUME THE COST OF ALL NECESSARY(B <NL>(B// SERVICING%% REPAIR OR CORRECTION.<NL>#include(B (B<stdio.h><NL>#include(B (B<errno.h><NL>#include(B (B<string.h><NL>#include(B (B<stdlib.h><NL>#include(B (B<netdb.h><NL>#include(B (B<sys/stat.h><NL>#include(B (B<sys/types.h><NL>#include(B (B<sys/socket.h><NL>#include(B (B<netinet/in.h><NL>(B^G(B Get Help     (B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos(B^Y(B Prev Page    (BM-\(B First Line<NL>(B^X(B Exit(B^R(B Read File    (B^\(B Replace(B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page    (BM-/(B Last Line<NL>(BEnter line number%% column number:                                                                                                (B(B^Y(B First Line      (B^T(B Go To Text(BC(B Cancel(B^V(B(B2(B(B1(B(B3(B<NL>char(B *status(int(B statcode) { (Bif(B (statcode == 200)    return(B (B"200 OK"(B;(Belse(B (Bif(B (statcode == 304) return(B (B"304 Not Modified"(B; (Belse(B (Bif(B (statcode == 400) return(B (B"400 Bad Request"(B; (Belse(B (Bif(B (statcode == 403) return(B (B"403 Forbidden"(B; (Belse(B (Bif(B (statcode == 404) return(B (B"404 Not Found"(B;(Belse(B (Bif(B (statcode == 500) return(B (B"500 Internal Server Error"(B; (Belse(B (Bif(B (statcode == 501) return(B (B"501 Not Implemented"(B; (Belse(B return(B (B""(B;<NL>int(B send_response(int(B sockfd%% httpreq_t *req%% int(B statcode) { int(B urifd; const(B int(B (BBUFSIZE(B = 2024; char(B sendmessage[(BBUFSIZE(B]; char(B *path = req->uri; (Bif(B (req->uri == (BNULL(B || req->method == (BNULL(B || (B req->headers == (BNULL(B || req->version == (BNULL(B) { return(B 0; }<NL> (Bif(B ((path[0] == (B'/'(B) || ((strstr(path%% (B"http://") == path)(B && (path = strchr(path + 7%%  (B'/'(B)))) { path += 1; (B// remove leading slash<NL>(B(B^O(B Write Out    (B^W(B Where Is     (B^K(B Cut Text     (B^J(B Justify(B^C(B Cur Pos      (B^Y(B Prev Page    (BM-\(B First Line(BX(B Exit  (B^R(B Read File    (B^\(B Replace      (B^U(B Uncut Text   (B^T(B To Spell     (B^_(B Go To Line   (B^V(B Next Page    (BM-/(B Last Line<NL> urifd;78<NL>M(BModified<NL>(B ( char(B  (B   = s2024;t2024;r2024;l2024;e2024;n2024;(2024;p2024;a2024;t2024;h2024;)2024;+2024;<NL>(BSave modified buffer (ANSWERING "No" WILL DESTROY CHANGES) ?                                                                      Y(B Yes<NL>(B N(B No  (BC(B Cancel<NL>(BFile Name to Write: webserver.c                             <NL>^G(B Get Help(BM-D(B DOS Format(BM-A(B Append(BM-B(B Backup File<NL>(B^C(B Cancel         (BM-M(B Mac Format(BM-P(B Prepend(B^T(B To Files(B (B[ Wrote 520 lines ](B<NL>(B        (B%,sudo nano webserver.c
CMBEGIN,Nov 28 12:29:47,/usr/src/fhttpd,sudo make,%gcc -D_FORTIFY_SOURCE=0 -frecord-gcc-switches -fno-stack-protector -z execstack -g -o webserver -D_TS_ERRNO webserver.c -lnsl -lresolv -lpthread<NL>webserver.c: In function 'send_response':<NL>webserver.c:282:9: warning: implicit declaration of function 'strptime' [-Wimplicit-function-declaration]<NL>    if (!strptime(imstime%% "%%a%% %%d %%b %%Y %%H:%%M:%%S GMT"%% &tm)<NL>         ^%,sudo make
